# coding=utf-8
import os

from core import SecurityTool
from core import SecurityToolsCollection


class Vegile(SecurityTool):
    TITLE = "Vegile - Ghost In The Shell"
    DESCRIPTION = "This tool will set up your backdoor/rootkits when " \
                  "backdoor is already setup it will be \n" \
                  "hidden your specific process,unlimited your session in " \
                  "metasploit and transparent."
    INSTALL_COMMANDS = [
        "sudo git clone https://github.com/Screetsec/Vegile.git",
        "cd Vegile && sudo chmod +x Vegile"
    ]
    RUN_COMMANDS = ["cd Vegile && sudo bash Vegile"]
    PROJECT_URL = "https://github.com/Screetsec/Vegile"

    def before_run(self):
        os.system('echo "You can Use Command: \n'
                  '[!] Vegile -i / --inject [backdoor/rootkit] \n'
                  '[!] Vegile -u / --unlimited [backdoor/rootkit] \n'
                  '[!] Vegile -h / --help"|boxes -d parchment')


class ChromeKeyLogger(SecurityTool):
    TITLE = "Chrome Keylogger"
    DESCRIPTION = "Hera Chrome Keylogger"
    INSTALL_COMMANDS = [
        "sudo git clone https://github.com/UndeadSec/HeraKeylogger.git",
        "cd HeraKeylogger && sudo apt-get install python3-pip -y && sudo pip3 install -r requirements.txt"
    ]
    RUN_COMMANDS = ["cd HeraKeylogger && sudo python3 hera.py"]
    PROJECT_URL = "https://github.com/UndeadSec/HeraKeylogger"


class Mimikatz(SecurityTool):
    TITLE = "Mimikatz"
    DESCRIPTION = "Mimikatz is a tool to extract plaintext passwords, hashes, and Kerberos tickets from memory"
    INSTALL_COMMANDS = ["sudo git clone https://github.com/gentilkiwi/mimikatz.git"]
    RUN_COMMANDS = ["cd mimikatz && sudo ./mimikatz.exe"]
    PROJECT_URL = "https://github.com/gentilkiwi/mimikatz"


class PowerSploit(SecurityTool):
    TITLE = "PowerSploit"
    DESCRIPTION = "PowerSploit is a collection of PowerShell modules for penetration testing"
    INSTALL_COMMANDS = ["sudo git clone https://github.com/PowerShellMafia/PowerSploit.git"]
    RUN_COMMANDS = ["cd PowerSploit && sudo powershell -ep bypass -c Import-Module .\\PowerSploit.ps1"]
    PROJECT_URL = "https://github.com/PowerShellMafia/PowerSploit"


class PostExploitationTools(SecurityToolsCollection):
    TITLE = "Post Exploitation Tools"
    TOOLS = [
        Vegile(),
        ChromeKeyLogger(),
        Mimikatz(),
        PowerSploit()
    ]
